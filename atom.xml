<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mao Yibo&#39;s Blog</title>
  <subtitle>A Notebook for Linux and Bioinformatics.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://maoyibo.tk/"/>
  <updated>2017-06-30T13:10:32.429Z</updated>
  <id>http://maoyibo.tk/</id>
  
  <author>
    <name>Mao Yibo</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>VCF 4.1版本 格式介绍</title>
    <link href="http://maoyibo.tk/2016/12/28/2016-12-28-VCF-Format/"/>
    <id>http://maoyibo.tk/2016/12/28/2016-12-28-VCF-Format/</id>
    <published>2016-12-28T08:54:56.000Z</published>
    <updated>2017-06-30T13:10:32.429Z</updated>
    
    <content type="html"><![CDATA[<p>注：VCF 4.1版本 格式说明文件（The Variant Call Format (VCF) Version 4.1 Specification）<a href="https://github.com/samtools/hts-specs" target="_blank" rel="external">下载地址</a>。</p>
<p>VCF 是一个文本文件格式，通常以压缩文件格式储存。包含元信息行，一个header行，然后是数据行，每个数据行包含一个基因组上位置的信息。VCF 格式也能够包含每个位置样品的基因型的信息。</p>
<a id="more"></a>  
<h2 id="元信息行"><a href="#元信息行" class="headerlink" title="元信息行"></a>元信息行</h2><p>文件的元信息行以##开始，而且必须是键=值对。推荐在元信息部分包含INFO, FILTER 和 FORMAT等出现在VCF文件body部分的条目的描述信息行。虽然这些是可选的，但是如果他们出现则需要被完全符合规则。</p>
<h4 id="fileformat"><a href="#fileformat" class="headerlink" title="fileformat"></a>fileformat</h4><p>一个单独的文件格式区域是必须的，而且必须出现在文件的第一行，描述VCF格式的版本。此行应该是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">##fileformat=VCFv4.1</div></pre></td></tr></table></figure></p>
<h3 id="INFO"><a href="#INFO" class="headerlink" title="INFO"></a>INFO</h3><p>INFO 区域应该应该如下描述（所有的键都是必须的）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">##INFO=&lt;ID=ID,Number=number,Type=type,Description=&quot;description&quot;&gt;</div></pre></td></tr></table></figure></p>
<p>INFO区域的类型可能是：整型，浮点，标记，符号和字符串。Number条目的值是整数，表示INFO区域可以包含的值的个数，如果INFO区域包含一个单独的数字则Number条目为’1’，如果包含一对数字则为’2’ ，如果对于每一个等位基因均有一个值则应为’A’，如果对于每一个可能的基因型均有一个值，则应为’G’，如果可能值的个数是变化的，或者未帮顶的，应为’.’。’Flag’类型表示INFO区域不包含一个值条目，Number条目应该是0。Description值应该被双引号包围，双引号中的双引号应使用\转意。</p>
<h3 id="FILTER"><a href="#FILTER" class="headerlink" title="FILTER"></a>FILTER</h3><p>应用于数据的过滤方法应该如下描述：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">##FILTER=&lt;ID=ID,Description=&quot;description&quot;&gt;</div></pre></td></tr></table></figure></p>
<h3 id="FORMAT"><a href="#FORMAT" class="headerlink" title="FORMAT"></a>FORMAT</h3><p>在FORMAT区域指定的基因型信息应该如下描述：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">##FORMAT=&lt;ID=ID,Number=number,Type=type,Description=&quot;description&quot;&gt;</div></pre></td></tr></table></figure></p>
<p>FORMAT区域可能的类型是：整数，浮点，字符和字符串。</p>
<h3 id="ALT"><a href="#ALT" class="headerlink" title="ALT"></a>ALT</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">##ALT=&lt;ID=type,Description=description&gt;</div></pre></td></tr></table></figure>
<h2 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;注：VCF 4.1版本 格式说明文件（The Variant Call Format (VCF) Version 4.1 Specification）&lt;a href=&quot;https://github.com/samtools/hts-specs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;下载地址&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;VCF 是一个文本文件格式，通常以压缩文件格式储存。包含元信息行，一个header行，然后是数据行，每个数据行包含一个基因组上位置的信息。VCF 格式也能够包含每个位置样品的基因型的信息。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Format" scheme="http://maoyibo.tk/tags/Format/"/>
    
      <category term="Unfinished" scheme="http://maoyibo.tk/tags/Unfinished/"/>
    
      <category term="VCF" scheme="http://maoyibo.tk/tags/VCF/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu 安装 MySQL 简便方法</title>
    <link href="http://maoyibo.tk/2016/12/27/2016-12-27-ubuntu-mysql-install/"/>
    <id>http://maoyibo.tk/2016/12/27/2016-12-27-ubuntu-mysql-install/</id>
    <published>2016-12-27T07:34:56.000Z</published>
    <updated>2017-06-30T13:10:29.561Z</updated>
    
    <content type="html"><![CDATA[<p>Ubuntu 14.04 官方软件源默认的MySQL是5.5版本，可以选择从软件源安装5.6版本但是不能从软件源安装mysql-workbench，因为其依赖5.5版本的MySQL。  </p>
<a id="more"></a>  
<p>为了方便的安装和更新MySQL可以选择添加MySQL的官方软件仓库。<a href="http://dev.mysql.com/downloads/repo/apt/" title="Download MySQL APT Repository" target="_blank" rel="external">此地址</a>是适用于debian和ubuntu的APT repository，你也可以根据需要选择YUM repository或者SUSE repository。<br>MySQL APT repository 包括以下软件包:  </p>
<ul>
<li>MySQL 5.7 (GA)</li>
<li>MySQL 5.6 (GA)</li>
<li>MySQL Workbench 6.3 (GA) - Ubuntu Only</li>
<li>MySQL Router</li>
<li>MySQL Utilities</li>
<li>MySQL Connector / Python</li>
</ul>
<p>下载“Ubuntu / Debian (Architecture Independent), DEB“ (mysql-apt-config_0.6.0-1_all.deb) 并安装。更新软件包列表后即可安装MySQL。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装APT repository</span></div><div class="line">$ sudo dpkg -i mysql-apt-config_0.6.0-1_all.deb</div><div class="line"><span class="comment">#安装时出现配置选项，可以选择mysql的版本和是否包括其他软件包</span></div><div class="line"><span class="comment">#更新软件包列表</span></div><div class="line">$ sudo apt-get update</div><div class="line"><span class="comment">#安装mysql-server</span></div><div class="line">$ sudo apt-get install mysql-server mysql-workbench</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Ubuntu 14.04 官方软件源默认的MySQL是5.5版本，可以选择从软件源安装5.6版本但是不能从软件源安装mysql-workbench，因为其依赖5.5版本的MySQL。  &lt;/p&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://maoyibo.tk/categories/Linux/"/>
    
    
      <category term="Ubuntu" scheme="http://maoyibo.tk/tags/Ubuntu/"/>
    
      <category term="Installation" scheme="http://maoyibo.tk/tags/Installation/"/>
    
      <category term="Database" scheme="http://maoyibo.tk/tags/Database/"/>
    
      <category term="MySQL" scheme="http://maoyibo.tk/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>TopHat使用方法</title>
    <link href="http://maoyibo.tk/2016/12/26/2016-12-26-tophat-useage/"/>
    <id>http://maoyibo.tk/2016/12/26/2016-12-26-tophat-useage/</id>
    <published>2016-12-26T13:53:35.000Z</published>
    <updated>2017-06-30T13:10:26.081Z</updated>
    
    <content type="html"><![CDATA[<p>TopHat是一个将RNA-Seq reads 比对到基因组上，来鉴定外显子-外显子剪接点的程序，其基于超快速短read mapping 程序 Bowtie。<br>TopHat 被设计用于Illumina Genome Analyzer所产生的reads，但是用户也成功地将其用于其他技术产生的reads。此软件1.1.0版本开始可以支持 Applied Biosystems 公司的 Colorspace format。此软件针对75bp或者更长的reads进行了优化。<br>注：本例使用的TopHat版本是：v2.1.0 。TopHat手册<a href="http://ccb.jhu.edu/software/tophat/manual.shtml" title="tophat manual" target="_blank" rel="external">查看此处</a>  </p>
<a id="more"></a>  
<h2 id="TopHat如何寻找剪接点"><a href="#TopHat如何寻找剪接点" class="headerlink" title="TopHat如何寻找剪接点"></a>TopHat如何寻找剪接点</h2><p>TopHat可以在没有参考注释的情况下寻找剪接点。通过首先将RNA-Seq reads比对到基因组，TopHat鉴定潜在的基因组，因为许多RNA-Seq reads 可以连续地比对到基因组上。使用这些最初的比对信息，TopHat构建可能的剪接点的数据库，然后比reads到到这些剪接点来确认他们。<br>当前的测序仪可以产生100bp 或更长的reads。但是许多外显子比这个长度更短，所以这些外显子可能在第一轮的mapping中被忽视。TopHat 通过将输入reads切割成更小的片段独立比对来解决这个问题。片段的比对在程序的最后一步放在一起产生end-to-end reads 比对。<br>TopHat产生可能剪接点的数据库从两个证据来源。一个剪接点的第一个也是最强的证据来源是当同一个read（最短45bp）的两个片段在同一个基因组系列比对到一个具体的距离，或者当一个内部片段不能比对表示这些reads跨越多个外显子。通过这些手段，可以从头开始发现 “GT-AG”, “GC-AG” 和 “AT-AC” 内含子。第二个证据来源是“覆盖岛”的配对，他们是在初始mapping 中不同的reads 对叠区域，相邻的岛经常在转录组中连接在一起，这样TopHat寻找方法来连接他们和一个内含子。只推荐用户对短的read (&lt; 45bp)，和小数目的reads (&lt;= 10 million) 使用第二个选项(–coverage-search) 。这个选项只报告跨过”GT-AG” 内含子的比对。</p>
<h2 id="使用TopHat"><a href="#使用TopHat" class="headerlink" title="使用TopHat"></a>使用TopHat</h2><p>TopHat 的参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line">$ tophat2 -h</div><div class="line">TopHat maps short sequences from spliced transcripts to whole genomes.</div><div class="line">Usage:</div><div class="line">    tophat [options] &lt;bowtie_index&gt; &lt;reads1[,reads2,...]&gt; [reads1[,reads2,...]] [quals1,[quals2,...]] [quals1[,quals2,...]]</div><div class="line">    <span class="comment">#bowtie_index  基因组索引的路径和basename</span></div><div class="line">    <span class="comment">#reads*  一个包含reads的文件，可以是fastq格式或者fasta格式</span></div><div class="line">    <span class="comment">#quals* 与fasta文件对应的质量文件</span></div><div class="line">Options:</div><div class="line">    -v/--version    <span class="comment">#版本</span></div><div class="line">    -o/--output-dir                &lt;string&gt;    [ default: ./tophat_out ] <span class="comment">#输出文件目录，默认 ./tophat_out</span></div><div class="line">    --bowtie1                                  [ default: bowtie2 ] <span class="comment">#使用bowtie1,默认bowtie2</span></div><div class="line">    -N/--<span class="built_in">read</span>-mismatches           &lt;int&gt;       [ default: 2 ]</div><div class="line">    --<span class="built_in">read</span>-gap-length              &lt;int&gt;       [ default: 2 ]</div><div class="line">    --<span class="built_in">read</span>-edit-dist               &lt;int&gt;       [ default: 2 ]</div><div class="line">    --<span class="built_in">read</span>-realign-edit-dist       &lt;int&gt;       [ default: <span class="string">"read-edit-dist"</span> + 1 ]</div><div class="line">    -a/--min-anchor                &lt;int&gt;       [ default: 8 ]</div><div class="line">    -m/--splice-mismatches         &lt;0-2&gt;       [ default: 0 ]</div><div class="line">    -i/--min-intron-length         &lt;int&gt;       [ default: 50 ]</div><div class="line">    -I/--max-intron-length         &lt;int&gt;       [ default: 500000  ]</div><div class="line">    -g/--max-multihits             &lt;int&gt;       [ default: 20 ]</div><div class="line">    --suppress-hits</div><div class="line">    -x/--transcriptome-max-hits    &lt;int&gt;       [ default: 60 ]</div><div class="line">    -M/--prefilter-multihits                   ( <span class="keyword">for</span> -G/--GTF option, <span class="built_in">enable</span> an initial bowtie search against the genome )</div><div class="line">    --max-insertion-length         &lt;int&gt;       [ default: 3 ]</div><div class="line">    --max-deletion-length          &lt;int&gt;       [ default: 3 ]</div><div class="line">    --solexa-quals      <span class="comment">#使用solexa分数</span></div><div class="line">    --solexa1.3-quals                          (same as phred64-quals) <span class="comment">#使用solexa1.3分数</span></div><div class="line">    --phred64-quals                            (same as solexa1.3-quals) <span class="comment">#使用phred64分数</span></div><div class="line">    -Q/--quals      <span class="comment">#分数</span></div><div class="line">    --<span class="built_in">integer</span>-quals     <span class="comment">#证书分数</span></div><div class="line">    -C/--color                                 (Solid - color space) <span class="comment">#Solid-色彩空间</span></div><div class="line">    --color-out     </div><div class="line">    --library-type                 &lt;string&gt;    (fr-unstranded, fr-firststrand, fr-secondstrand)</div><div class="line">    -p/--num-threads               &lt;int&gt;       [ default: 1 ]</div><div class="line">    -R/--resume                    &lt;out_dir&gt;   ( try to resume execution )</div><div class="line">    -G/--GTF                       &lt;filename&gt;  (GTF/GFF with known transcripts)</div><div class="line">    --transcriptome-index          &lt;bwtidx&gt;    (transcriptome bowtie index)</div><div class="line">    -T/--transcriptome-only                    (map only to the transcriptome)</div><div class="line">    -j/--raw-juncs                 &lt;filename&gt;   <span class="comment">#未处理的剪切点</span></div><div class="line">    --insertions                   &lt;filename&gt;</div><div class="line">    --deletions                    &lt;filename&gt;</div><div class="line">    -r/--mate-inner-dist           &lt;int&gt;       [ default: 50 ]</div><div class="line">    --mate-std-dev                 &lt;int&gt;       [ default: 20 ]</div><div class="line">    --no-novel-juncs</div><div class="line">    --no-novel-indels</div><div class="line">    --no-gtf-juncs</div><div class="line">    --no-coverage-search</div><div class="line">    --coverage-search</div><div class="line">    --microexon-search</div><div class="line">    --keep-tmp</div><div class="line">    --tmp-dir                      &lt;dirname&gt;   [ default: &lt;output_dir&gt;/tmp ]</div><div class="line">    -z/--zpacker                   &lt;program&gt;   [ default: gzip ]</div><div class="line">    -X/--unmapped-fifo                         [use mkfifo to compress more temporary files <span class="keyword">for</span> color space reads]</div><div class="line">Advanced Options:</div><div class="line">    --report-secondary-alignments</div><div class="line">    --no-discordant</div><div class="line">    --no-mixed</div><div class="line">    --segment-mismatches           &lt;int&gt;       [ default: 2 ]</div><div class="line">    --segment-length               &lt;int&gt;       [ default: 25 ] <span class="comment">#片段长度</span></div><div class="line">    --bowtie-n                                 [ default: bowtie -v ]</div><div class="line">    --min-coverage-intron          &lt;int&gt;       [ default: 50 ]</div><div class="line">    --max-coverage-intron          &lt;int&gt;       [ default: 20000 ]</div><div class="line">    --min-segment-intron           &lt;int&gt;       [ default: 50 ]</div><div class="line">    --max-segment-intron           &lt;int&gt;       [ default: 500000 ]</div><div class="line">    --no-sort-bam                              (Output BAM is not coordinate-sorted)</div><div class="line">    --no-convert-bam                           (Do not output bam format. Output is &lt;output_dir&gt;/accepted_hits.sam)</div><div class="line">    --keep-fasta-order</div><div class="line">    --allow-partial-mapping</div><div class="line">Bowtie2 related options:</div><div class="line">  Preset options <span class="keyword">in</span> --end-to-end mode (<span class="built_in">local</span> alignment is not used <span class="keyword">in</span> TopHat2) <span class="comment">#预设的选项是 --end-to-end模式，(local alignment在TopHat2中不能被使用)</span></div><div class="line">    --b2-very-fast</div><div class="line">    --b2-fast</div><div class="line">    --b2-sensitive</div><div class="line">    --b2-very-sensitive</div><div class="line">  Alignment options</div><div class="line">    --b2-N                         &lt;int&gt;       [ default: 0 ]</div><div class="line">    --b2-L                         &lt;int&gt;       [ default: 20 ]</div><div class="line">    --b2-i                         &lt;func&gt;      [ default: S,1,1.25 ]</div><div class="line">    --b2-n-ceil                    &lt;func&gt;      [ default: L,0,0.15 ]</div><div class="line">    --b2-gbar                      &lt;int&gt;       [ default: 4 ]</div><div class="line">  Scoring options</div><div class="line">    --b2-mp                        &lt;int&gt;,&lt;int&gt; [ default: 6,2 ]</div><div class="line">    --b2-np                        &lt;int&gt;       [ default: 1 ]</div><div class="line">    --b2-rdg                       &lt;int&gt;,&lt;int&gt; [ default: 5,3 ]</div><div class="line">    --b2-rfg                       &lt;int&gt;,&lt;int&gt; [ default: 5,3 ]</div><div class="line">    --b2-score-min                 &lt;func&gt;      [ default: L,-0.6,-0.6 ]</div><div class="line">  Effort options</div><div class="line">    --b2-D                         &lt;int&gt;       [ default: 15 ]</div><div class="line">    --b2-R                         &lt;int&gt;       [ default: 2 ]</div><div class="line">Fusion related options:</div><div class="line">    --fusion-search</div><div class="line">    --fusion-anchor-length         &lt;int&gt;       [ default: 20 ]</div><div class="line">    --fusion-min-dist              &lt;int&gt;       [ default: 10000000 ]</div><div class="line">    --fusion-read-mismatches       &lt;int&gt;       [ default: 2 ]</div><div class="line">    --fusion-multireads            &lt;int&gt;       [ default: 2 ]</div><div class="line">    --fusion-multipairs            &lt;int&gt;       [ default: 2 ]</div><div class="line">    --fusion-ignore-chromosomes    &lt;list&gt;      [ e.g, &lt;chrM,chrX&gt; ]</div><div class="line">    --fusion-do-not-resolve-conflicts          [this is <span class="keyword">for</span> <span class="built_in">test</span> purposes ]</div><div class="line">SAM Header Options (<span class="keyword">for</span> embedding sequencing run metadata <span class="keyword">in</span> output):</div><div class="line">    --rg-id                        &lt;string&gt;    (<span class="built_in">read</span> group ID)</div><div class="line">    --rg-sample                    &lt;string&gt;    (sample ID)</div><div class="line">    --rg-library                   &lt;string&gt;    (library ID)</div><div class="line">    --rg-description               &lt;string&gt;    (descriptive string, no tabs allowed)</div><div class="line">    --rg-platform-unit             &lt;string&gt;    (e.g Illumina lane ID)</div><div class="line">    --rg-center                    &lt;string&gt;    (sequencing center name)</div><div class="line">    --rg-date                      &lt;string&gt;    (ISO 8601 date of the sequencing run)</div><div class="line">    --rg-platform                  &lt;string&gt;    (Sequencing platform descriptor)</div><div class="line">    <span class="keyword">for</span> detailed <span class="built_in">help</span> see http://tophat.cbcb.umd.edu/manual.html</div></pre></td></tr></table></figure></p>
<p>当使用TopHat处理双末端reads时 将 *_1文件和 *_2文件放到不同的以逗号分割的文件列表，两个列表中文件的顺序应当一致。<br>TopHat允许用户在配对reads之后使用附加的未配对的reads。TopHat在2.0.10版本之后支持混合格式输入，但是不推荐。</p>
<p>未完待续……</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;TopHat是一个将RNA-Seq reads 比对到基因组上，来鉴定外显子-外显子剪接点的程序，其基于超快速短read mapping 程序 Bowtie。&lt;br&gt;TopHat 被设计用于Illumina Genome Analyzer所产生的reads，但是用户也成功地将其用于其他技术产生的reads。此软件1.1.0版本开始可以支持 Applied Biosystems 公司的 Colorspace format。此软件针对75bp或者更长的reads进行了优化。&lt;br&gt;注：本例使用的TopHat版本是：v2.1.0 。TopHat手册&lt;a href=&quot;http://ccb.jhu.edu/software/tophat/manual.shtml&quot; title=&quot;tophat manual&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;查看此处&lt;/a&gt;  &lt;/p&gt;
    
    </summary>
    
    
      <category term="NGS" scheme="http://maoyibo.tk/tags/NGS/"/>
    
      <category term="Mapper" scheme="http://maoyibo.tk/tags/Mapper/"/>
    
      <category term="Manual" scheme="http://maoyibo.tk/tags/Manual/"/>
    
      <category term="Commands" scheme="http://maoyibo.tk/tags/Commands/"/>
    
      <category term="Unfinished" scheme="http://maoyibo.tk/tags/Unfinished/"/>
    
      <category term="RNASeq" scheme="http://maoyibo.tk/tags/RNASeq/"/>
    
  </entry>
  
  <entry>
    <title>SAM 格式介绍</title>
    <link href="http://maoyibo.tk/2016/12/25/2016-12-25-SAM-Format/"/>
    <id>http://maoyibo.tk/2016/12/25/2016-12-25-SAM-Format/</id>
    <published>2016-12-25T06:33:13.000Z</published>
    <updated>2017-06-30T13:10:19.633Z</updated>
    
    <content type="html"><![CDATA[<p>注：SAM格式说明文件（Sequence Alignment/Map Format Specification）<a href="https://github.com/samtools/hts-specs" target="_blank" rel="external">下载地址</a>。</p>
<p>SAM格式是以以TAB分割的文本格式，包括可选的Header和Alignment部分。</p>
<a id="more"></a>  
<h1 id="Header部分"><a href="#Header部分" class="headerlink" title="Header部分"></a>Header部分</h1><p><strong>Header</strong> 部分如果出现，必须在Alignment部分的前面。Header的每一行都需要以’@’开始。在’@’之后是一个预定义的由两个字母组成的Header记录类型编码。除了@CO，每个Header记录类型的数据区都需要遵守’TAG:VALUE’格式，TAG同样由两个字符构成，第一个自负必须是字母，第二个可以是数字，TAG定义Value的格式和内容。每个每个Header都有必选的TAG。<br>SAM定义了五种Header记录类型编码：  </p>
<ul>
<li>@HD   首行，如果出现则出现在文件的第一行。  <ul>
<li>VN*   格式版本。  </li>
</ul>
</li>
<li>@SQ   参考序列字典。@SQ行根据其比对排序的顺序排序。  <ul>
<li>SN*   参考序列名称。此处的值将出现在alignment部分的RNAME和RNEXT中。</li>
<li>LN*   参考序列长度。</li>
</ul>
</li>
<li>@RG   Read组。允许有多个未排序的@RG行。<ul>
<li>ID*   Read组标识符 每一个@RG行都必须有一个唯一的ID。这个ID将在Aligmane部分中的RG tag被使用。  </li>
</ul>
</li>
<li>@PG 软件  <ul>
<li>ID* 软件标识符。每一个@PG行都需要有一个唯一的ID。</li>
</ul>
</li>
<li>@CO   单行的文字描述。可以有多个未排序的@CO行。</li>
</ul>
<p>注：’*‘标记的TAG为必选项<br>可以自由的为新的数据区添加新的TAG，推荐自己添加的TAG使用小写字母表示。</p>
<h1 id="Alignment部分"><a href="#Alignment部分" class="headerlink" title="Alignment部分"></a>Alignment部分</h1><p><strong>Alignment</strong> 部分的每一行表示一个片段的线性比对，不以’@’开始。每一行包括11个记录比对信息的必选字段（mandatory fields），和可变数目的可选字段。必选字段以规定的顺序出现，并且必须出现，当值不可取的时候可是’0’或’*‘。  </p>
<h2 id="必选字段"><a href="#必选字段" class="headerlink" title="必选字段"></a>必选字段</h2><ul>
<li>1.QNAME：查询的模板名称。Reads或者Segments拥有相同的QNAME被认为是来自同一个模板。如果信息不可用则用’*‘表示。在一个SAM文件中，当嵌合比对或者多mappings出现，一个read可能占据多个alignment行。</li>
<li>2.FLAG：FLAG 按位的结合。每一个bit的解释如下:  </li>
</ul>
<table>
<thead>
<tr>
<th>DEC Bit</th>
<th>HEX Bit</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0x1</td>
<td>template having multiple segments in sequencing</td>
</tr>
<tr>
<td>2</td>
<td>0x2</td>
<td>each segment properly aligned according to the aligner</td>
</tr>
<tr>
<td>4</td>
<td>0x4</td>
<td>segment unmapped</td>
</tr>
<tr>
<td>8</td>
<td>0x8</td>
<td>next segment in the template unmapped</td>
</tr>
<tr>
<td>16</td>
<td>0x10</td>
<td>SEQ being reverse complemented</td>
</tr>
<tr>
<td>32</td>
<td>0x20</td>
<td>SEQ of the next segment in the template being reverse complemented</td>
</tr>
<tr>
<td>64</td>
<td>0x40</td>
<td>the first segment in the template</td>
</tr>
<tr>
<td>128</td>
<td>0x80</td>
<td>the last segment in the template</td>
</tr>
<tr>
<td>256</td>
<td>0x100</td>
<td>secondary alignment</td>
</tr>
<tr>
<td>512</td>
<td>0x200</td>
<td>not passing filters, such as platform/vendor quality controls</td>
</tr>
<tr>
<td>1024</td>
<td>0x400</td>
<td>PCR or optical duplicate</td>
</tr>
<tr>
<td>2048</td>
<td>0x800</td>
<td>supplementary alignment</td>
</tr>
</tbody>
</table>
<blockquote>
<p>对于SAM文件中的每一个read/contig，需要与之相关的行中有且只有一行满足’FLAG &amp; 0x900==0’，即有且只有一个不满足’supplementary alignment’ 和 ‘secondary alignment’，这行被称作read的 <strong>‘主要的行(primary line)’</strong> 。<br>没有出现在列表里面的位被留作以后使用。在当前的软件中他们不应该被设置，在读取中应该被忽略。<br>0x1 表示模板在测序中有多个片段，如果0x1未被设置，则不能假设0x2，0x8，0x20，0x40和0x80的值(即这些位的值为0)。<br>0x4 只有在表示read是否未被mapped被设置，如果0x4 被设置，则不能假设RNAME, POS, CIGAR, MAPQ, and bits 0x2, 0x100, 和 0x800的值(即这些位的值为0)。<br>0x10 表示SEQ和QUAL是否反转，当0x4未被设置，其片段比对上的序列相一致。当0x4被设置时表示这个未被mapped的read是否以测序仪输出的原始方向储存。<br>0x40 0x80 如果同时被设置，这个片段是模板的一个线性部分，但是他既不是第一个也不是最后一个read。如果0x40 和 0x80没有设置，read在模板中的索引是未知的。这可能发生在一个非线性模板或者或者索引在数据操作中丢失的情况。<br>0x100 表示当使用的软件能够识别这个bit时，这个比对在确定的分析中将不会被使用。它通常使用在标记可变的mapping，当多mappings出现在SAM中。<br>0x800 表示相应的比对行是一个嵌合比对的一部分。一个标记0x800的行被称作一个附加行。</p>
</blockquote>
<ul>
<li>3.RNAME：比对的参考序列名称。如果@SQ header行出现，RNAME（如果不是’*‘）必须出现在一个@SQ的SN tag 中。一个没有mapped的片段没有坐标，在此位置使用’*‘。然而一个没有mapped的片段也可能又有一个普通的坐标，这样它可以在排序后放置在合适的位置。如果 RNAME 是’*‘，不能假设POS和CIGAR的值。  </li>
<li>4.POS：1-based 最左边第一个碱基的mapping位置。参考序列的第一个碱基的坐标是1。一个没有 mapped 的read 没有坐标，POS值为0 。如果POS值为0 ,则不能假设RNAME 和 CIGAR的值。</li>
<li>5.MAPQ：mapping的质量。它等于 $ -10log_{10}Pr ${mapping position is wrong}，取最近的整数。值255表示mapping的质量是不可取的。  </li>
<li>6.CIGAR：CIGAR字符串，具体信息查看下表，如果CIGAR值不可取设置为’*‘：</li>
</ul>
<table>
<thead>
<tr>
<th>Op</th>
<th>BAM</th>
<th>Description</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>M</td>
<td>0</td>
<td>alignment match (can be a sequence match or mismatch)</td>
<td>比对匹配（可以是sequence match或mismatch）</td>
</tr>
<tr>
<td>I</td>
<td>1</td>
<td>insertion to the reference</td>
<td>插入参考序列</td>
</tr>
<tr>
<td>D</td>
<td>2</td>
<td>deletion from the reference</td>
<td>删除参考序列</td>
</tr>
<tr>
<td>N</td>
<td>3</td>
<td>skipped region from the reference</td>
<td>跳过参考序列的区域</td>
</tr>
<tr>
<td>S</td>
<td>4</td>
<td>soft clipping (clipped sequences present in SEQ)</td>
<td>柔性剪切（剪切SEQ中的序列）</td>
</tr>
<tr>
<td>H</td>
<td>5</td>
<td>hard clipping (clipped sequences NOT present in SEQ)</td>
<td>硬性剪切（剪切非SEQ中的序列）</td>
</tr>
<tr>
<td>P</td>
<td>6</td>
<td>padding (silent deletion from padded reference)</td>
<td>填充（从填充参考中沉默剪切）</td>
</tr>
<tr>
<td>=</td>
<td>7</td>
<td>sequence match</td>
<td>序列匹配</td>
</tr>
<tr>
<td>X</td>
<td>8</td>
<td>sequence mismatch</td>
<td>序列不匹配</td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li>H 只出现在操作字符串的第一位或者最后一位。</li>
<li>S 只可以有H操作在其和CIFAR末尾之间。</li>
<li>对于mRNA-to-genome比对，一个N操作表示内含子。对于其它类型的比对，N的解释是未定义的。</li>
<li>M/I/S/=/X操作的总和应该等于SEQ的长度。</li>
</ul>
</blockquote>
<ul>
<li>7.RNEXT：模板的下一个read的主要比对的参考序列名。对于一个模板的最后一个read，下一个read就是下一个模板的第一个read。如果@SQ header存在，RNEXT（如果不是’*‘）必须出现在一个@SQ的SN tag 中。如果该区域是’*‘表示该信息不可取，如果是’=’表示RNEXT 与 RNAME 相同。如果不是’=’而且模板中的下一个read有一个主要比对，这个区域和下一个read的主要比对的RNAME相同。如果RNAME是’*‘，则不能假定PNEXT 和 0x20的值。</li>
<li>8.PNEXT：模板中下一个read的主要比对的位置。如果该信息去可取的话其值为0。此处的值等于下一个read的主要比对的POS值。如果PNEXT值是0,则不能假定RNEXT 和 0x20的值。</li>
<li>9.TLEN：有符号的观察到的模板的长度。如果所有的片段比对到相同的参考序列，无符号的观察到的模板长度等于左边mapped到的碱基到右边mapped到的碱基的碱基数目。最左边的片段标记为正号，最右边的标记为负号，中间片段的符号未定义。如果信息不可用或者是单片段模板的话其值设为0。</li>
<li>10.SEQ：片段序列，如果序列没有被储存则表示为’*‘。如果一个’*‘，序列的长度必须等于CIGAR字符串中M/I/S/=/X操作符的长度。’=’表示碱基和参考序列碱基一致。没有关于字母情况的假设。</li>
<li>11.QUAL：碱基质量加上33的ASCII码表示，如果质量没有储存的话可以用’*‘表示。如果此处不是’*‘，则SEQ必须不是’*‘，并且质量字符串的长度应该和SEQ的长度相等。</li>
</ul>
<h2 id="可选字段"><a href="#可选字段" class="headerlink" title="可选字段"></a>可选字段</h2><p>所有的可选字段必须满足TAG:TYPE:VALUE的格式。TAG必须是以字母开始的两位字符。每个TAG在一行中只能出现一次。小写字符表示的TAG被留给最终用户。TYPE是一个大小写敏感的字符，定义VALUE的格式。</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Regexp matching VALUE</th>
<th>Description</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>[!-~]</td>
<td>Printable character</td>
<td>可打印的字符串</td>
</tr>
<tr>
<td>i</td>
<td>[-+]?[0-9]+</td>
<td>Signed integer</td>
<td>有符号的整数</td>
</tr>
<tr>
<td>f</td>
<td>[-+]?[0-9]*.?[0-9]+([eE][-+]?[0-9]+)?</td>
<td>Single-precision floating number</td>
<td>单精度浮点数</td>
</tr>
<tr>
<td>Z</td>
<td>[ !-~]+</td>
<td>Printable string, including space</td>
<td>可打印的字符串，包括空格</td>
</tr>
<tr>
<td>H</td>
<td>[0-9A-F]+</td>
<td>Byte array in the Hex format</td>
<td>十六进制的字节数组</td>
</tr>
<tr>
<td>B</td>
<td>[cCsSiIf](,[-+]?[0-9]*.?[0-9]+([eE][-+]?[0-9]+)?)+</td>
<td>Integer or numeric array</td>
<td>整数或数字数组</td>
</tr>
</tbody>
</table>
<p>未完待续……</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;注：SAM格式说明文件（Sequence Alignment/Map Format Specification）&lt;a href=&quot;https://github.com/samtools/hts-specs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;下载地址&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;SAM格式是以以TAB分割的文本格式，包括可选的Header和Alignment部分。&lt;/p&gt;
    
    </summary>
    
    
      <category term="SAM" scheme="http://maoyibo.tk/tags/SAM/"/>
    
      <category term="Format" scheme="http://maoyibo.tk/tags/Format/"/>
    
      <category term="Unfinished" scheme="http://maoyibo.tk/tags/Unfinished/"/>
    
  </entry>
  
  <entry>
    <title>使用 Bowtie2 将reads 比对到参考基因组</title>
    <link href="http://maoyibo.tk/2016/12/24/2016-12-24-Bowtie2-useage/"/>
    <id>http://maoyibo.tk/2016/12/24/2016-12-24-Bowtie2-useage/</id>
    <published>2016-12-24T06:27:23.000Z</published>
    <updated>2017-06-30T13:10:12.601Z</updated>
    
    <content type="html"><![CDATA[<p>注：本例使用的bowtie2 版本为：version 2.2.6<br>bowtie2的使用需要两种输入文件：<br><strong>Reference genome data (fasta格式 .fa, .fasta, .fna)</strong><br>本文使用的例子是Escherichia coli 参考基因组（gi|15829254|ref|NC_002695.1| Escherichia coli O157:H7 str. Sakai chromosome, complete genome）。<br>文件下载后命名为ecoli.fa</p>
<a id="more"></a>  
<p><strong>Short reads data (fastaq格式 .fastaq, .fq)</strong><br>本文使用的read数据是从SRA获得的 SRR2982241 reads数据。  </p>
<ul>
<li>Name: NexteraXT</li>
<li>Instrument: Illumina MiSeq</li>
<li>Strategy: WGS</li>
<li>Source: GENOMIC</li>
<li>Selection: RANDOM</li>
<li>Layout: PAIRED</li>
<li>Construction protocol: NexteraXT</li>
</ul>
<p>首先使用sratoolkit中的fastq-dump 对下载的 SRR2982241.sra 格式文件转换格式为fastq格式文件，并将序列分开。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ fastq-dump --split-files SRR2982241.sra</div></pre></td></tr></table></figure></p>
<p>生成文件 SRR2982241_1.fastq 和 SRR2982241_2.fastq</p>
<h2 id="使用-bowtie2-build-对参考基因组建立索引"><a href="#使用-bowtie2-build-对参考基因组建立索引" class="headerlink" title="使用 bowtie2-build 对参考基因组建立索引"></a>使用 bowtie2-build 对参考基因组建立索引</h2><p>bowtie2-build 参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">$ bowtie2-build -h</div><div class="line">Bowtie 2 version 2.2.6 by Ben Langmead (langmea@cs.jhu.edu, www.cs.jhu.edu/~langmea)</div><div class="line">Usage: bowtie2-build [options]* &lt;reference_in&gt; &lt;bt2_index_base&gt;</div><div class="line">    reference_in            comma-separated list of files with ref sequences</div><div class="line">                                    <span class="comment">#使用逗号分割的参考序列文件</span></div><div class="line">    bt2_index_base          write bt2 data to files with this dir/basename</div><div class="line">                                    <span class="comment">#bt2数据输出文件</span></div><div class="line">*** Bowtie 2 indexes work only with v2 (not v1).  Likewise <span class="keyword">for</span> v1 indexes. ***</div><div class="line">Options:</div><div class="line">    -f                      reference files are Fasta (default)</div><div class="line">    -c                      reference sequences given on cmd line (as &lt;reference_in&gt;)</div><div class="line">    --large-index           force generated index to be <span class="string">'large'</span>, even <span class="keyword">if</span> ref has fewer than 4 billion nucleotides</div><div class="line">    -a/--noauto             <span class="built_in">disable</span> automatic -p/--bmax/--dcv memory-fitting</div><div class="line">    -p/--packed             use packed strings internally; slower, less memory</div><div class="line">    --bmax &lt;int&gt;            max bucket sz <span class="keyword">for</span> blockwise suffix-array builder</div><div class="line">    --bmaxdivn &lt;int&gt;        max bucket sz as divisor of ref len (default: 4)</div><div class="line">    --dcv &lt;int&gt;             diff-cover period <span class="keyword">for</span> blockwise (default: 1024)</div><div class="line">    --nodc                  <span class="built_in">disable</span> diff-cover (algorithm becomes quadratic)</div><div class="line">    -r/--noref              don<span class="string">'t build .3/.4 index files</span></div><div class="line">    -3/--justref            just build .3/.4 index files</div><div class="line">    -o/--offrate &lt;int&gt;      SA is sampled every 2^&lt;int&gt; BWT chars (default: 5)</div><div class="line">    -t/--ftabchars &lt;int&gt;    # of chars consumed in initial lookup (default: 10)</div><div class="line">    --seed &lt;int&gt;            seed for random number generator</div><div class="line">    -q/--quiet              verbose output (for debugging)</div><div class="line">    -h/--help               print detailed description of tool and its options</div><div class="line">    --usage                 print this usage message</div><div class="line">    --version               print version information and quit</div></pre></td></tr></table></figure></p>
<p>本例使用命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bowtie2-build ecoli.fa ecoli</div></pre></td></tr></table></figure></p>
<p>输出索引文件有6个：<br>ecoli.1.bt2，ecoli.2.bt2，ecoli.3.bt2，ecoli.4.bt2，ecoli.rev.1.bt2，ecoli.rev.2.bt2</p>
<h2 id="使用-bowtie2-将reads-比对到参考基因组"><a href="#使用-bowtie2-将reads-比对到参考基因组" class="headerlink" title="使用 bowtie2 将reads 比对到参考基因组"></a>使用 bowtie2 将reads 比对到参考基因组</h2><p>bowtie2  参数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div></pre></td><td class="code"><pre><div class="line">$ bowtie2 -h</div><div class="line">Bowtie 2 version 2.2.6 by Ben Langmead (langmea@cs.jhu.edu, www.cs.jhu.edu/~langmea)</div><div class="line">Usage: </div><div class="line">  bowtie2 [options]* -x &lt;bt2-idx&gt; &#123;-1 &lt;m1&gt; -2 &lt;m2&gt; | -U &lt;r&gt;&#125; [-S &lt;sam&gt;]</div><div class="line"></div><div class="line">  &lt;bt2-idx&gt;  Index filename prefix (minus trailing .X.bt2).</div><div class="line">             NOTE: Bowtie 1 and Bowtie 2 indexes are not compatible.</div><div class="line">  &lt;m1&gt;       Files with <span class="comment">#1 mates, paired with files in &lt;m2&gt;.</span></div><div class="line">             Could be gzip<span class="string">'ed (extension: .gz) or bzip2'</span>ed (extension: .bz2).</div><div class="line">  &lt;m2&gt;       Files with <span class="comment">#2 mates, paired with files in &lt;m1&gt;.</span></div><div class="line">             Could be gzip<span class="string">'ed (extension: .gz) or bzip2'</span>ed (extension: .bz2).</div><div class="line">  &lt;r&gt;        Files with unpaired reads.</div><div class="line">             Could be gzip<span class="string">'ed (extension: .gz) or bzip2'</span>ed (extension: .bz2).</div><div class="line">  &lt;sam&gt;      File <span class="keyword">for</span> SAM output (default: stdout)</div><div class="line"></div><div class="line">  &lt;m1&gt;, &lt;m2&gt;, &lt;r&gt; can be comma-separated lists (no whitespace) and can be</div><div class="line">  specified many <span class="built_in">times</span>.  E.g. <span class="string">'-U file1.fq,file2.fq -U file3.fq'</span>.</div><div class="line"></div><div class="line">Options (defaults <span class="keyword">in</span> parentheses):</div><div class="line"></div><div class="line"> Input:</div><div class="line">  -q                 query input files are FASTQ .fq/.fastq (default)</div><div class="line">  --qseq             query input files are <span class="keyword">in</span> Illumina<span class="string">'s qseq format</span></div><div class="line">  -f                 query input files are (multi-)FASTA .fa/.mfa</div><div class="line">  -r                 query input files are raw one-sequence-per-line</div><div class="line">  -c                 &lt;m1&gt;, &lt;m2&gt;, &lt;r&gt; are sequences themselves, not files</div><div class="line">  -s/--skip &lt;int&gt;    skip the first &lt;int&gt; reads/pairs in the input (none)</div><div class="line">  -u/--upto &lt;int&gt;    stop after first &lt;int&gt; reads/pairs (no limit)</div><div class="line">  -5/--trim5 &lt;int&gt;   trim &lt;int&gt; bases from 5'/left end of reads (0)</div><div class="line">  -3/--trim3 &lt;int&gt;   trim &lt;int&gt; bases from 3<span class="string">'/right end of reads (0)</span></div><div class="line">  --phred33          qualities are Phred+33 (default)</div><div class="line">  --phred64          qualities are Phred+64</div><div class="line">  --int-quals        qualities encoded as space-delimited integers</div><div class="line"></div><div class="line"> Presets:                 Same as:</div><div class="line">  For --end-to-end:</div><div class="line">   --very-fast            -D 5 -R 1 -N 0 -L 22 -i S,0,2.50</div><div class="line">   --fast                 -D 10 -R 2 -N 0 -L 22 -i S,0,2.50</div><div class="line">   --sensitive            -D 15 -R 2 -N 0 -L 22 -i S,1,1.15 (default)</div><div class="line">   --very-sensitive       -D 20 -R 3 -N 0 -L 20 -i S,1,0.50</div><div class="line"></div><div class="line">  For --local:</div><div class="line">   --very-fast-local      -D 5 -R 1 -N 0 -L 25 -i S,1,2.00</div><div class="line">   --fast-local           -D 10 -R 2 -N 0 -L 22 -i S,1,1.75</div><div class="line">   --sensitive-local      -D 15 -R 2 -N 0 -L 20 -i S,1,0.75 (default)</div><div class="line">   --very-sensitive-local -D 20 -R 3 -N 0 -L 20 -i S,1,0.50</div><div class="line"></div><div class="line"> Alignment:</div><div class="line">  -N &lt;int&gt;           max # mismatches in seed alignment; can be 0 or 1 (0)</div><div class="line">  -L &lt;int&gt;           length of seed substrings; must be &gt;3, &lt;32 (22)</div><div class="line">  -i &lt;func&gt;          interval between seed substrings w/r/t read len (S,1,1.15)</div><div class="line">  --n-ceil &lt;func&gt;    func for max # non-A/C/G/Ts permitted in aln (L,0,0.15)</div><div class="line">  --dpad &lt;int&gt;       include &lt;int&gt; extra ref chars on sides of DP table (15)</div><div class="line">  --gbar &lt;int&gt;       disallow gaps within &lt;int&gt; nucs of read extremes (4)</div><div class="line">  --ignore-quals     treat all quality values as 30 on Phred scale (off)</div><div class="line">  --nofw             do not align forward (original) version of read (off)</div><div class="line">  --norc             do not align reverse-complement version of read (off)</div><div class="line">  --no-1mm-upfront   do not allow 1 mismatch alignments before attempting to</div><div class="line">                     scan for the optimal seeded alignments</div><div class="line">  --end-to-end       entire read must align; no clipping (on)</div><div class="line">   OR</div><div class="line">  --local            local alignment; ends might be soft clipped (off)</div><div class="line"></div><div class="line"> Scoring:</div><div class="line">  --ma &lt;int&gt;         match bonus (0 for --end-to-end, 2 for --local) </div><div class="line">  --mp &lt;int&gt;         max penalty for mismatch; lower qual = lower penalty (6)</div><div class="line">  --np &lt;int&gt;         penalty for non-A/C/G/Ts in read/ref (1)</div><div class="line">  --rdg &lt;int&gt;,&lt;int&gt;  read gap open, extend penalties (5,3)</div><div class="line">  --rfg &lt;int&gt;,&lt;int&gt;  reference gap open, extend penalties (5,3)</div><div class="line">  --score-min &lt;func&gt; min acceptable alignment score w/r/t read length</div><div class="line">                     (G,20,8 for local, L,-0.6,-0.6 for end-to-end)</div><div class="line"></div><div class="line"> Reporting:</div><div class="line">  (default)          look for multiple alignments, report best, with MAPQ</div><div class="line">   OR</div><div class="line">  -k &lt;int&gt;           report up to &lt;int&gt; alns per read; MAPQ not meaningful</div><div class="line">   OR</div><div class="line">  -a/--all           report all alignments; very slow, MAPQ not meaningful</div><div class="line"></div><div class="line"> Effort:</div><div class="line">  -D &lt;int&gt;           give up extending after &lt;int&gt; failed extends in a row (15)</div><div class="line">  -R &lt;int&gt;           for reads w/ repetitive seeds, try &lt;int&gt; sets of seeds (2)</div><div class="line"></div><div class="line"> Paired-end:</div><div class="line">  -I/--minins &lt;int&gt;  minimum fragment length (0)</div><div class="line">  -X/--maxins &lt;int&gt;  maximum fragment length (500)</div><div class="line">  --fr/--rf/--ff     -1, -2 mates align fw/rev, rev/fw, fw/fw (--fr)</div><div class="line">  --no-mixed         suppress unpaired alignments for paired reads</div><div class="line">  --no-discordant    suppress discordant alignments for paired reads</div><div class="line">  --no-dovetail      not concordant when mates extend past each other</div><div class="line">  --no-contain       not concordant when one mate alignment contains other</div><div class="line">  --no-overlap       not concordant when mates overlap at all</div><div class="line"></div><div class="line"> Output:</div><div class="line">  -t/--time          print wall-clock time taken by search phases</div><div class="line">  --un &lt;path&gt;           write unpaired reads that didn't align to &lt;path&gt;</div><div class="line">  --al &lt;path&gt;           write unpaired reads that aligned at least once to &lt;path&gt;</div><div class="line">  --un-conc &lt;path&gt;      write pairs that didn<span class="string">'t align concordantly to &lt;path&gt;</span></div><div class="line">  --al-conc &lt;path&gt;      write pairs that aligned concordantly at least once to &lt;path&gt;</div><div class="line">  (Note: for --un, --al, --un-conc, or --al-conc, add '-gz<span class="string">' to the option name, e.g.</span></div><div class="line">  --un-gz &lt;path&gt;, to gzip compress output, or add '-bz2<span class="string">' to bzip2 compress output.)</span></div><div class="line">  --quiet            print nothing to stderr except serious errors</div><div class="line">  --met-file &lt;path&gt;  send metrics to file at &lt;path&gt; (off)</div><div class="line">  --met-stderr       send metrics to stderr (off)</div><div class="line">  --met &lt;int&gt;        report internal counters &amp; metrics every &lt;int&gt; secs (1)</div><div class="line">  --no-unal          supppress SAM records for unaligned reads</div><div class="line">  --no-head          supppress header lines, i.e. lines starting with @</div><div class="line">  --no-sq            supppress @SQ header lines</div><div class="line">  --rg-id &lt;text&gt;     set read group id, reflected in @RG line and RG:Z: opt field</div><div class="line">  --rg &lt;text&gt;        add &lt;text&gt; ("lab:value") to @RG line of SAM header.</div><div class="line">                     Note: @RG line only printed when --rg-id is set.</div><div class="line">  --omit-sec-seq     put '*<span class="string">' in SEQ and QUAL fields for secondary alignments.</span></div><div class="line"></div><div class="line"> Performance:</div><div class="line">  -p/--threads &lt;int&gt; number of alignment threads to launch (1)</div><div class="line">  --reorder          force SAM output order to match order of input reads</div><div class="line">  --mm               use memory-mapped I/O for index; many 'bowtie<span class="string">'s can share</span></div><div class="line"></div><div class="line"> Other:</div><div class="line">  --qc-filter        filter out reads that are bad according to QSEQ filter</div><div class="line">  --seed &lt;int&gt;       seed for random number generator (0)</div><div class="line">  --non-deterministic seed rand. gen. arbitrarily instead of using read attributes</div><div class="line">  --version          print version information and quit</div><div class="line">  -h/--help          print this usage message</div></pre></td></tr></table></figure></p>
<p>bowtie2 默认执行 end-to-end read 比对，且本例使用Paired-end reads 使用命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">$ bowtie2 -x ecoli -1 SRR2982241_1_filtered.fastq -2 SRR2982241_2_filtered.fastq -S SRR2982241.ETE.sam</div><div class="line"><span class="comment">#程序输出</span></div><div class="line">1340783 reads; of these:</div><div class="line">  1340783 (100.00%) were paired; of these:</div><div class="line">    967025 (72.12%) aligned concordantly 0 <span class="built_in">times</span></div><div class="line">    357153 (26.64%) aligned concordantly exactly 1 time</div><div class="line">    16605 (1.24%) aligned concordantly &gt;1 <span class="built_in">times</span></div><div class="line">    ----</div><div class="line">    967025 pairs aligned concordantly 0 <span class="built_in">times</span>; of these:</div><div class="line">      485924 (50.25%) aligned discordantly 1 time</div><div class="line">    ----</div><div class="line">    481101 pairs aligned 0 <span class="built_in">times</span> concordantly or discordantly; of these:</div><div class="line">      962202 mates make up the pairs; of these:</div><div class="line">        834252 (86.70%) aligned 0 <span class="built_in">times</span></div><div class="line">        73901 (7.68%) aligned exactly 1 time</div><div class="line">        54049 (5.62%) aligned &gt;1 <span class="built_in">times</span></div><div class="line">68.89% overall alignment rate</div></pre></td></tr></table></figure></p>
<p>bowtie2 执行 Local read 比对，使用命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">$ bowtie2 --<span class="built_in">local</span> -x ecoli -1 SRR2982241_1_filtered.fastq -2 SRR2982241_2_filtered.fastq -S SRR2982241.LOCAL.sam</div><div class="line"><span class="comment">#程序输出</span></div><div class="line">1340783 reads; of these:</div><div class="line">  1340783 (100.00%) were paired; of these:</div><div class="line">    918570 (68.51%) aligned concordantly 0 <span class="built_in">times</span></div><div class="line">    384568 (28.68%) aligned concordantly exactly 1 time</div><div class="line">    37645 (2.81%) aligned concordantly &gt;1 <span class="built_in">times</span></div><div class="line">    ----</div><div class="line">    918570 pairs aligned concordantly 0 <span class="built_in">times</span>; of these:</div><div class="line">      492349 (53.60%) aligned discordantly 1 time</div><div class="line">    ----</div><div class="line">    426221 pairs aligned 0 <span class="built_in">times</span> concordantly or discordantly; of these:</div><div class="line">      852442 mates make up the pairs; of these:</div><div class="line">        724379 (84.98%) aligned 0 <span class="built_in">times</span></div><div class="line">        44099 (5.17%) aligned exactly 1 time</div><div class="line">        83964 (9.85%) aligned &gt;1 <span class="built_in">times</span></div><div class="line">72.99% overall alignment rate</div></pre></td></tr></table></figure></p>
<p>对与Single-end reads 使用命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#End-to-end:</span></div><div class="line">bowtie2 -x ecoli -U SRR2982241.fastq -S SRR2982241.ETE.sam</div><div class="line"></div><div class="line"><span class="comment">#Local:</span></div><div class="line">bowtie2 --<span class="built_in">local</span> -x ecoli -U SRR2982241.fastq -S SRR2982241.LOCAL.sam</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;注：本例使用的bowtie2 版本为：version 2.2.6&lt;br&gt;bowtie2的使用需要两种输入文件：&lt;br&gt;&lt;strong&gt;Reference genome data (fasta格式 .fa, .fasta, .fna)&lt;/strong&gt;&lt;br&gt;本文使用的例子是Escherichia coli 参考基因组（gi|15829254|ref|NC_002695.1| Escherichia coli O157:H7 str. Sakai chromosome, complete genome）。&lt;br&gt;文件下载后命名为ecoli.fa&lt;/p&gt;
    
    </summary>
    
    
      <category term="NGS" scheme="http://maoyibo.tk/tags/NGS/"/>
    
      <category term="Mapper" scheme="http://maoyibo.tk/tags/Mapper/"/>
    
      <category term="Manual" scheme="http://maoyibo.tk/tags/Manual/"/>
    
      <category term="Commands" scheme="http://maoyibo.tk/tags/Commands/"/>
    
  </entry>
  
  <entry>
    <title>NGS Terminologies and Concepts</title>
    <link href="http://maoyibo.tk/2016/12/20/2016-12-20-NGS-Terminologies-and-Concepts/"/>
    <id>http://maoyibo.tk/2016/12/20/2016-12-20-NGS-Terminologies-and-Concepts/</id>
    <published>2016-12-20T09:04:40.000Z</published>
    <updated>2017-06-30T13:10:07.249Z</updated>
    
    <content type="html"><![CDATA[<ol>
<li><strong>Template</strong><br> A DNA/RNA sequence part of which is sequenced on a sequencing machine or assembled from raw sequences.<br> 一个DNA/RNA序列，此序列可以通过测序仪测出或者由原始序列组装而成。<br> <em>注：此Template就是分子生物学意义上的DNA模板或RNA模板，和参考序列没有关系。</em><br> <em>source:Sequence Alignment/Map Format Specification</em>  <a id="more"></a>  </li>
<li><strong>Segment</strong><br> A contiguous sequence or subsequence.<br> 一个连续的序列或者子序列。<br> <em>source:Sequence Alignment/Map Format Specification</em></li>
<li><strong>Read</strong><br> A raw sequence that comes off a sequencing machine. A read may consist of multiple segments. For sequencing data, reads are indexed by the order in which they are sequenced.<br> 一个从测序仪输出的原始序列。一个read可以由多个segment构成。对于测序数据，reads通过他们被测序的顺序索引。<br> <em>source:Sequence Alignment/Map Format Specification</em></li>
<li><strong>Linear alignment</strong><br> An alignment of a read to a single reference sequence that may include insertions, deletions, skips and clipping, but may not include direction changes (i.e. one portion of the alignment on forward strand and another portion of alignment on reverse strand). A linear alignment can be represented in a single SAM record.<br> 将一个read比对到一个单一的参考序列可能包括插入、删除、跳跃和裁剪，但是不会包括方向的改变（比如：比对的一部分在正向链，另外一部分在反向链）。一个线性比对可以使用单一的SAM记录表示。<br> <em>source:Sequence Alignment/Map Format Specification</em>  </li>
<li><strong>Chimeric alignment</strong><br> An alignment of a read that cannot be represented as a linear alignment. A chimeric alignment is represented as a set of linear alignments that do not have large overlaps. Typically, one of the linear alignments in a chimeric alignment is considered the “representative” alignment, and the others are called “supplementary” and are distinguished by the supplementary alignment flag. All the SAM records in a chimeric alignment have the same QNAME and the same values for 0x40 and 0x80 flags. The decision regarding which linear alignment is representative is arbitrary.<br> 一个read的比对不能被表示为一个线性比对。一个嵌合比对表现为一组没有大的重叠的线性比对。一般情况下，嵌合比对中的一个线性比对被认为是“代表性比对”，另外一个被认为是“补充比对”，两者通过附加的比对标签区别。一个嵌合比对的所有SAM记录都有相同的QNAME以及相同的 0x40 和 0x80 标签值。决定哪一个线性比对是代表性比对是随意的。<br> <em>source:Sequence Alignment/Map Format Specification</em></li>
<li><strong>Read alignment</strong><br> A linear alignment or a chimeric alignment that is the complete representation of the alignment of the read.<br> 完全表示read比对的一个线性比对或者嵌合比对。<br> <em>source:Sequence Alignment/Map Format Specification</em></li>
<li><strong>Multiple mapping</strong><br> The correct placement of a read may be ambiguous, e.g. due to repeats. In this case, there may be multiple read alignments for the same read. One of these alignments is considered primary. All the other alignments have the secondary alignment flag set in the SAM records that represent them. All the SAM records have the same QNAME and the same values for 0x40 and 0x80 flags. Typically the alignment designated primary is the best alignment, but the decision may be arbitrary.<br> 由于重复等原因，read的正确位置可能是模棱两可的。在这种情况下，对于相同的read可能有多个比对方式。这些比对方式中的一个被考虑为主要的，所有其他的比对方式在SAM记录中拥有次要比对标签集来表示他们。所有的SAM记录拥有相同的QNAME和 0x40 与 0x80 的值。一般情况下首要的比对方案是最优的比对方案，但是决定可能是随意的。<br> <em>source:Sequence Alignment/Map Format Specification</em></li>
<li><strong>1-based coordinate system</strong><br> A coordinate system where the first base of a sequence is one. In this coordinate system, a region is specified by a closed interval. For example, the region between the 3rd and the 7th bases inclusive is [3, 7]. The SAM, VCF, GFF and Wiggle formats are using the 1-based coordinate system.<br> 一个坐标系统，其中序列的第一个碱基是1，在这个坐标系统中，一个区域通过一个封闭区间指定。比如，在第三和第七碱基首尾之间的区域表示为[3,7]。SAM，VCF，GFF和Wiggle格式使用1-based 坐标系统。<br> <em>注：在0-based坐标系统中第一个碱基的编号是1</em><br> <em>source:Sequence Alignment/Map Format Specification</em></li>
<li><strong>0-based coordinate system</strong><br> A coordinate system where the first base of a sequence is zero. In this coordinate system, a region is specified by a half-closed-half-open interval. For example, the region between the 3rd and the 7th bases inclusive is [2, 7). The BAM, BCFv2, BED, and PSL formats are using the 0-based coordinate system.<br> 一个坐标系统，其中序列的第一个碱基是0，在这个坐标系统中，一个区域通过一个半封闭半开放的区间指定。比如，在第三和第七碱基首尾之间的区域表示为[2,7)。BAM, BCFv2, BED, 和 PSL formats使用0-based 坐标系统。<br> <em>注：在0-based坐标系统中第一个碱基的编号是0</em><br> <em>source:Sequence Alignment/Map Format Specification</em></li>
<li><strong>Phred scale</strong><br>Given a probability $0 &lt; p \le 1$, the phred scale of p equals $-10log<em>{10}p$, rounded to the closest integer.<br>对于给定的概率 $0 &lt; p \le 1$，p 的 phred 刻度等于 $-10log</em>{10}p$，取最近的整数。<br><em>注：和<a href="https://en.wikipedia.org/wiki/Phred_quality_score" title="Phred quality score" target="_blank" rel="external">“Phred quality score”</a>意思相同。</em><br><em>source:Sequence Alignment/Map Format Specification</em>  </li>
</ol>
<p>未完待续……</p>
]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Template&lt;/strong&gt;&lt;br&gt; A DNA/RNA sequence part of which is sequenced on a sequencing machine or assembled from raw sequences.&lt;br&gt; 一个DNA/RNA序列，此序列可以通过测序仪测出或者由原始序列组装而成。&lt;br&gt; &lt;em&gt;注：此Template就是分子生物学意义上的DNA模板或RNA模板，和参考序列没有关系。&lt;/em&gt;&lt;br&gt; &lt;em&gt;source:Sequence Alignment/Map Format Specification&lt;/em&gt;
    
    </summary>
    
    
      <category term="NGS" scheme="http://maoyibo.tk/tags/NGS/"/>
    
      <category term="Terminologies" scheme="http://maoyibo.tk/tags/Terminologies/"/>
    
      <category term="Concepts" scheme="http://maoyibo.tk/tags/Concepts/"/>
    
  </entry>
  
  <entry>
    <title>使用samtools发现SNPs</title>
    <link href="http://maoyibo.tk/2016/12/13/2016-12-13-samtools-useage/"/>
    <id>http://maoyibo.tk/2016/12/13/2016-12-13-samtools-useage/</id>
    <published>2016-12-13T04:29:23.000Z</published>
    <updated>2017-06-30T13:10:02.885Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>samtools 是一个操作sam/bam文件的软件包，其最新的1.3版本和经典的0.1.19版本软件参数不同，使用前需注意使用的软件版本。<br>注：本文使用的samtools版本是 0.1.19-44428cd，定义命令为samtools19，其中附带的bcftools版本是 0.1.19-44428cd，定义命令为bcftools19，vcfutils命令定义为vcfutils19。<br>使用的文件是“使用 bwa 将 reads 比对到参考基因组”例子中产生的paired-end.sam文件。</p>
<a id="more"></a>  
<h2 id="使用samtools-faidx-对参考序列进行索引"><a href="#使用samtools-faidx-对参考序列进行索引" class="headerlink" title="使用samtools faidx 对参考序列进行索引"></a>使用samtools faidx 对参考序列进行索引</h2><p>samtools faidx 参数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ samtools19 faidx</div><div class="line">        Usage: faidx &lt;in.fasta&gt; [&lt;reg&gt; [...]]</div></pre></td></tr></table></figure></p>
<p>本例使用命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ samtools19 faidx ecoli.fa</div></pre></td></tr></table></figure></p>
<p>输出结果： ecoli.fa.fai</p>
<h2 id="使用samtools-view-将sam格式的结果转为bam格式"><a href="#使用samtools-view-将sam格式的结果转为bam格式" class="headerlink" title="使用samtools view 将sam格式的结果转为bam格式"></a>使用samtools view 将sam格式的结果转为bam格式</h2><p> samtools view 参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">$ samtools19 view</div><div class="line">Usage:   samtools view [options] &lt;in.bam&gt;|&lt;in.sam&gt; [region1 [...]]</div><div class="line">Options: </div><div class="line">         -b             output BAM</div><div class="line">                    <span class="comment">#输出BAM</span></div><div class="line">         -h             <span class="built_in">print</span> header <span class="keyword">for</span> the SAM output</div><div class="line">         -H             <span class="built_in">print</span> header only (no alignments)</div><div class="line">         -S             input is SAM</div><div class="line">                    <span class="comment">#输入SAM</span></div><div class="line">         -u             uncompressed BAM output (force -b)</div><div class="line">         -1             fast compression (force -b)</div><div class="line">         -x             output FLAG <span class="keyword">in</span> HEX (samtools-C specific)</div><div class="line">         -X             output FLAG <span class="keyword">in</span> string (samtools-C specific)</div><div class="line">         -c             <span class="built_in">print</span> only the count of matching records</div><div class="line">         -B             collapse the backward CIGAR operation</div><div class="line">         -@ INT     number of BAM compression threads [0]</div><div class="line">         -L FILE        output alignments overlapping the input BED FILE [null]</div><div class="line">         -t FILE        list of reference names and lengths (force -S) [null]</div><div class="line">         -T FILE        reference sequence file (force -S) [null]</div><div class="line">         -o FILE        output file name [stdout]</div><div class="line">                        <span class="comment">#指定输出文件名而不是标准输出</span></div><div class="line">         -R FILE        list of <span class="built_in">read</span> groups to be outputted [null]</div><div class="line">         -f INT         required flag, 0 <span class="keyword">for</span> <span class="built_in">unset</span> [0]</div><div class="line">         -F INT         filtering flag, 0 <span class="keyword">for</span> <span class="built_in">unset</span> [0]</div><div class="line">         -q INT         minimum mapping quality [0]</div><div class="line">         -l STR         only output reads <span class="keyword">in</span> library STR [null]</div><div class="line">         -r STR         only output reads <span class="keyword">in</span> <span class="built_in">read</span> group STR [null]</div><div class="line">         -s FLOAT     fraction of templates to subsample; <span class="built_in">integer</span> part as seed [-1]</div><div class="line">         -?                 longer <span class="built_in">help</span></div></pre></td></tr></table></figure></p>
<p>本例使用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ samtools19 view -b -S -o paired-end.bam paired-end.sam</div></pre></td></tr></table></figure>
<h2 id="使用-samtools-sort-对bam结果进行排序"><a href="#使用-samtools-sort-对bam结果进行排序" class="headerlink" title="使用 samtools sort 对bam结果进行排序"></a>使用 samtools sort 对bam结果进行排序</h2><p>samtools sort参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$samtools19</span> sort</div><div class="line">Usage:   samtools sort [options] &lt;in.bam&gt; &lt;out.prefix&gt;</div><div class="line">Options: </div><div class="line">         -n            sort by <span class="built_in">read</span> name</div><div class="line">         -f             use &lt;out.prefix&gt; as full file name instead of prefix</div><div class="line">         -o            final output to stdout</div><div class="line">         -l INT      compression level, from 0 to 9 [-1]</div><div class="line">         -@ INT    number of sorting and compression threads [1]</div><div class="line">         -m INT    max memory per thread; suffix K/M/G recognized [768M]</div></pre></td></tr></table></figure></p>
<p>本例使用命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ samtools19 sort paired-end.bam paired-end.sorted</div></pre></td></tr></table></figure></p>
<h2 id="使用-samtools-index-对排序后的bam文件建立索引"><a href="#使用-samtools-index-对排序后的bam文件建立索引" class="headerlink" title="使用 samtools index 对排序后的bam文件建立索引"></a>使用 samtools index 对排序后的bam文件建立索引</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$samtools19</span> index</div><div class="line">Usage: samtools index &lt;in.bam&gt; [out.index]</div></pre></td></tr></table></figure>
<p>本例命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ samtools19 index paired-end.sorted.bam</div></pre></td></tr></table></figure></p>
<h2 id="使用-samtools-mpileup-结合-bcftools-view-生成二进制bcf-格式文件"><a href="#使用-samtools-mpileup-结合-bcftools-view-生成二进制bcf-格式文件" class="headerlink" title="使用 samtools mpileup 结合 bcftools view 生成二进制bcf 格式文件"></a>使用 samtools mpileup 结合 bcftools view 生成二进制bcf 格式文件</h2><p><strong>samtools mpileup 参数</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">$ samtools19 mpileup</div><div class="line"></div><div class="line">Usage: samtools mpileup [options] in1.bam [in2.bam [...]]</div><div class="line"></div><div class="line">Input options:</div><div class="line">  -6, --illumina1.3+      quality is <span class="keyword">in</span> the Illumina-1.3+ encoding</div><div class="line">  -A, --count-orphans     <span class="keyword">do</span> not discard anomalous <span class="built_in">read</span> pairs</div><div class="line">  -b, --bam-list FILE     list of input BAM filenames, one per line</div><div class="line">  -B, --no-BAQ            <span class="built_in">disable</span> BAQ (per-Base Alignment Quality)</div><div class="line">  -C, --adjust-MQ INT     adjust mapping quality; recommended:50, <span class="built_in">disable</span>:0 [0]</div><div class="line">                    <span class="comment">#调整mapping质量，推荐50,0为关闭</span></div><div class="line">  -d, --max-depth INT     max per-BAM depth; avoids excessive memory usage [250]</div><div class="line">  -E, --redo-BAQ          recalculate BAQ on the fly, ignore existing BQs</div><div class="line">  -f, --fasta-ref FILE    faidx indexed reference sequence file</div><div class="line">                    <span class="comment">#faidx 索引过的参考序列</span></div><div class="line">  -G, --exclude-RG FILE   exclude <span class="built_in">read</span> groups listed <span class="keyword">in</span> FILE</div><div class="line">  -l, --positions FILE    skip unlisted positions (chr pos) or regions (BED)</div><div class="line">  -q, --min-MQ INT        skip alignments with mapQ smaller than INT [0]</div><div class="line">  -Q, --min-BQ INT        skip bases with baseQ/BAQ smaller than INT [13]</div><div class="line">  -r, --region REG        region <span class="keyword">in</span> <span class="built_in">which</span> pileup is generated</div><div class="line">  -R, --ignore-RG         ignore RG tags (one BAM = one sample)</div><div class="line">  --rf, --incl-flags STR|INT  required flags: skip reads with mask bits <span class="built_in">unset</span> []</div><div class="line">  --ff, --excl-flags STR|INT  filter flags: skip reads with mask bits <span class="built_in">set</span></div><div class="line">                                            [UNMAP,SECONDARY,QCFAIL,DUP]</div><div class="line">  -x, --ignore-overlaps   <span class="built_in">disable</span> <span class="built_in">read</span>-pair overlap detection</div><div class="line"></div><div class="line">Output options:</div><div class="line">  -o, --output FILE       write output to FILE [standard output]</div><div class="line">  -g, --BCF               generate genotype likelihoods <span class="keyword">in</span> BCF format</div><div class="line">                    <span class="comment">#使用BCF格式产生基因型可能性</span></div><div class="line">  -v, --VCF               generate genotype likelihoods <span class="keyword">in</span> VCF format</div><div class="line">                    <span class="comment">#使用VCF格式产生基因型可能性</span></div><div class="line"></div><div class="line">Output options <span class="keyword">for</span> mpileup format (without -g/-v):</div><div class="line">  -O, --output-BP         output base positions on reads</div><div class="line">  -s, --output-MQ         output mapping quality</div><div class="line"></div><div class="line">Output options <span class="keyword">for</span> genotype likelihoods (when -g/-v is used):</div><div class="line">  -t, --output-tags LIST  optional tags to output: DP,DPR,DV,DP4,INFO/DPR,SP []</div><div class="line">  -u, --uncompressed      generate uncompressed VCF/BCF output</div><div class="line">                    <span class="comment">#产生非压缩的VCF/BCF 输出</span></div><div class="line"></div><div class="line">SNP/INDEL genotype likelihoods options (effective with -g/-v):</div><div class="line">  -e, --ext-prob INT      Phred-scaled gap extension seq error probability [20]</div><div class="line">  -F, --gap-frac FLOAT    minimum fraction of gapped reads [0.002]</div><div class="line">  -h, --tandem-qual INT   coefficient <span class="keyword">for</span> homopolymer errors [100]</div><div class="line">  -I, --skip-indels       <span class="keyword">do</span> not perform indel calling</div><div class="line">  -L, --max-idepth INT    maximum per-sample depth <span class="keyword">for</span> INDEL calling [250]</div><div class="line">  -m, --min-ireads INT    minimum number gapped reads <span class="keyword">for</span> indel candidates [1]</div><div class="line">  -o, --open-prob INT     Phred-scaled gap open seq error probability [40]</div><div class="line">  -p, --per-sample-mF     apply -m and -F per-sample <span class="keyword">for</span> increased sensitivity</div><div class="line">  -P, --platforms STR     comma separated list of platforms <span class="keyword">for</span> indels [all]</div><div class="line"></div><div class="line">Notes: Assuming diploid individuals.</div></pre></td></tr></table></figure>
<p> <strong>bcftools view参数</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">$ bcftools19 view</div><div class="line"></div><div class="line">Usage: bcftools view [options] &lt;in.bcf&gt; [reg]</div><div class="line"></div><div class="line">Input/output options:</div><div class="line"></div><div class="line">       -A        keep all possible alternate alleles at variant sites</div><div class="line">       -b        output BCF instead of VCF</div><div class="line">       -D FILE   sequence dictionary <span class="keyword">for</span> VCF-&gt;BCF conversion [null]</div><div class="line">       -F        PL generated by r921 or before (<span class="built_in">which</span> generate old ordering)</div><div class="line">       -G        suppress all individual genotype information</div><div class="line">       -l FILE   list of sites (chr pos) or regions (BED) to output [all sites]</div><div class="line">       -L        calculate LD <span class="keyword">for</span> adjacent sites</div><div class="line">       -N        skip sites <span class="built_in">where</span> REF is not A/C/G/T</div><div class="line">       -Q        output the QCALL likelihood format</div><div class="line">       -s FILE   list of samples to use [all samples]</div><div class="line">       -S        input is VCF</div><div class="line">       -u        uncompressed BCF output (force -b)</div><div class="line"></div><div class="line">Consensus/variant calling options:</div><div class="line"></div><div class="line">       -c        SNP calling (force -e)</div><div class="line">       -d FLOAT  skip loci <span class="built_in">where</span> less than FLOAT fraction of samples covered [0]</div><div class="line">       -e        likelihood based analyses</div><div class="line">       -g        call genotypes at variant sites (force -c)</div><div class="line">       -i FLOAT  indel-to-substitution ratio [-1]</div><div class="line">       -I        skip indels</div><div class="line">       -m FLOAT  alternative model <span class="keyword">for</span> multiallelic and rare-variant calling, include <span class="keyword">if</span> P(chi^2)&gt;=FLOAT</div><div class="line">       -p FLOAT  variant <span class="keyword">if</span> P(ref|D)&lt;FLOAT [0.5]</div><div class="line">       -P STR    <span class="built_in">type</span> of prior: full, cond2, flat [full]</div><div class="line">       -t FLOAT  scaled substitution mutation rate [0.001]</div><div class="line">       -T STR    constrained calling; STR can be: pair, trioauto, trioxd and trioxs (see manual) [null]</div><div class="line">       -v        output potential variant sites only (force -c)</div><div class="line"></div><div class="line">Contrast calling and association <span class="built_in">test</span> options:</div><div class="line"></div><div class="line">       -1 INT    number of group-1 samples [0]</div><div class="line">       -C FLOAT  posterior constrast <span class="keyword">for</span> LRT&lt;FLOAT and P(ref|D)&lt;0.5 [1]</div><div class="line">       -U INT    number of permutations <span class="keyword">for</span> association testing (effective with -1) [0]</div><div class="line">       -X FLOAT  only perform permutations <span class="keyword">for</span> P(chi^2)&lt;FLOAT [0.01]</div></pre></td></tr></table></figure>
<p>本例使用参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ samtools19 mpileup -u -f ecoli.fa paired-end.sorted.bam |bcftools19 view -bvcg - &gt; paired-end.sorted.raw.bcf</div></pre></td></tr></table></figure></p>
<p>##使用 bcftools view 结合 vcfutils 转换并生成 vcf 结果。</p>
<p>vcfutils<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$ $ vcfutils19  varFilter</div><div class="line">Usage:   vcfutils.pl varFilter [options] &lt;in.vcf&gt;</div><div class="line">Options: -Q INT    minimum RMS mapping quality <span class="keyword">for</span> SNPs [10]</div><div class="line">         -d INT    minimum <span class="built_in">read</span> depth [2]</div><div class="line">         -D INT    maximum <span class="built_in">read</span> depth [10000000]</div><div class="line">         -a INT    minimum number of alternate bases [2]</div><div class="line">         -w INT    SNP within INT bp around a gap to be filtered [3]</div><div class="line">         -W INT    window size <span class="keyword">for</span> filtering adjacent gaps [10]</div><div class="line">         -1 FLOAT  min P-value <span class="keyword">for</span> strand bias (given PV4) [0.0001]</div><div class="line">         -2 FLOAT  min P-value <span class="keyword">for</span> baseQ bias [1e-100]</div><div class="line">         -3 FLOAT  min P-value <span class="keyword">for</span> mapQ bias [0]</div><div class="line">         -4 FLOAT  min P-value <span class="keyword">for</span> end distance bias [0.0001]</div><div class="line">		 -e FLOAT  min P-value <span class="keyword">for</span> HWE (plus F&lt;0) [0.0001]</div><div class="line">         -p        <span class="built_in">print</span> filtered variants</div><div class="line"></div><div class="line">Note: Some of the filters rely on annotations generated by SAMtools/BCFtools.</div></pre></td></tr></table></figure></p>
<p>本例使用命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bcftools19 view paired-end.sorted.raw.bcf | vcfutils19 varFilter -D 200 &gt;paired-end.sorted.flt.vcf</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;samtools 是一个操作sam/bam文件的软件包，其最新的1.3版本和经典的0.1.19版本软件参数不同，使用前需注意使用的软件版本。&lt;br&gt;注：本文使用的samtools版本是 0.1.19-44428cd，定义命令为samtools19，其中附带的bcftools版本是 0.1.19-44428cd，定义命令为bcftools19，vcfutils命令定义为vcfutils19。&lt;br&gt;使用的文件是“使用 bwa 将 reads 比对到参考基因组”例子中产生的paired-end.sam文件。&lt;/p&gt;
    
    </summary>
    
    
      <category term="NGS" scheme="http://maoyibo.tk/tags/NGS/"/>
    
      <category term="Manual" scheme="http://maoyibo.tk/tags/Manual/"/>
    
      <category term="Commands" scheme="http://maoyibo.tk/tags/Commands/"/>
    
      <category term="SNP" scheme="http://maoyibo.tk/tags/SNP/"/>
    
      <category term="SNV" scheme="http://maoyibo.tk/tags/SNV/"/>
    
  </entry>
  
  <entry>
    <title>使用 bwa 将 reads 比对到参考基因组</title>
    <link href="http://maoyibo.tk/2016/12/12/2016-12-12-bwa-useage/"/>
    <id>http://maoyibo.tk/2016/12/12/2016-12-12-bwa-useage/</id>
    <published>2016-12-12T14:02:04.000Z</published>
    <updated>2017-06-30T13:09:58.201Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Bwa (Burrows-Wheeler Alignment Tool) 是一个将低分散序列比对到人类基因组等大参考基因组的软件包。它由三个算法组成：BWA-backtrack，BWA-SW 和 BWA-MEM。第一个算法BWA-backtrack针对最长 100bp 的 Illumina sequence reads。另外两个算法BWA-SW 和 BWA-MEM针对从70bp 到 1Mbp 的长序列。BWA-SW 和 BWA-MEM 具有相同的特征，比如长read的支持，支持分裂比对，但是BWA-MEM是最新的，更快，更精准，推荐用于高质量比对。 BWA-MEM 和 BWA-backtrack 相比处理70-100bp Illumina reads 拥有更好的性能。<br>对于所有的算法，BWA首先需要构建参考基因组的FM-index（使用 index 命令）。比对算法通过调用不同的子命令实现：BWA-backtrack 算法使用aln/samse/sampe，BWA-SW算法使用 bwasw，BWA-MEM 算法使用mem。<br>注：本例使用的bwa版本为：0.7.12-r1039。BWA手册<a href="http://bio-bwa.sourceforge.net/bwa.shtml" target="_blank" rel="external">查看此处</a>。</p>
<a id="more"></a>  
<p>bwa的使用需要两种输入文件：<br><strong>Reference genome data (fasta格式 .fa, .fasta, .fna)</strong><br>本文使用的例子是Escherichia coli 参考基因组（gi|15829254|ref|NC_002695.1| Escherichia coli O157:H7 str. Sakai chromosome, complete genome）。<br>文件下载后命名为ecoli.fa</p>
<p><strong>Short reads data (fastaq格式 .fastaq, .fq)</strong><br>本文使用的read数据是从SRA获得的 SRR2982241 reads数据。  </p>
<ul>
<li>Name: NexteraXT</li>
<li>Instrument: Illumina MiSeq</li>
<li>Strategy: WGS</li>
<li>Source: GENOMIC</li>
<li>Selection: RANDOM</li>
<li>Layout: PAIRED</li>
<li>Construction protocol: NexteraXT</li>
</ul>
<p>首先使用sratoolkit中的fastq-dump 对下载的 SRR2982241.sra 格式文件转换格式为fastq格式文件，并将序列分开。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ fastq-dump --split-files SRR2982241.sra</div></pre></td></tr></table></figure></p>
<p>生成文件 SRR2982241_1.fastq 和 SRR2982241_2.fastq</p>
<h2 id="使用-bwa-index-对参考基因组建立索引"><a href="#使用-bwa-index-对参考基因组建立索引" class="headerlink" title="使用 bwa index 对参考基因组建立索引"></a>使用 bwa index 对参考基因组建立索引</h2><p>bwa index 索引fasta格式的参考基因组序列，其参数如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$ bwa index</div><div class="line">Usage:   bwa index [options] &lt;in.fasta&gt;</div><div class="line">Options: </div><div class="line">        -a STR    BWT construction algorithm: bwtsw or is [auto]</div><div class="line">                    #BWT构建算法bwtsw 或 is ，默认自动选择</div><div class="line">        -p STR    prefix of the index [same as fasta name]  </div><div class="line">                    #输出的索引的前缀，默认和FASTA文件名相同</div><div class="line">        -b INT    block size for the bwtsw algorithm (effective with -a bwtsw) [10000000]   </div><div class="line">                    #bwtsw算法的块大小，当使用bwtsw算法时生效，默认10000000</div><div class="line">        -6        index files named as &lt;in.fasta&gt;.64.* instead of &lt;in.fasta&gt;.*  </div><div class="line">                    #输出的索引文件名中有.64.标记</div><div class="line">                    </div><div class="line">Warning: `-a bwtsw&apos; does not work for short genomes, while `-a is&apos; and `-a div&apos; do not work not for long genomes.</div><div class="line">#警告：`-a bwtsw&apos;不适用于短基因组，而`-a is&apos;  和 `-a div&apos; 不适用于长基因组</div></pre></td></tr></table></figure></p>
<p>本例使用的是大肠杆菌基因组，属于short genomes，使用`-a is’参数。使用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bwa index -a is ecoli.fa</div></pre></td></tr></table></figure>
<p>默认生成文件的前缀和输入文件相同，输出文件有:ecoli.fa.ann， ecoli.fa.pac， ecoli.fa.amb， ecoli.fa.bwt， ecoli.fa.sa。</p>
<h2 id="使用-bwa-aln-定位序列的阵列坐标-（SA-coordinates）"><a href="#使用-bwa-aln-定位序列的阵列坐标-（SA-coordinates）" class="headerlink" title="使用 bwa aln 定位序列的阵列坐标 （SA coordinates）"></a>使用 bwa aln 定位序列的阵列坐标 （SA coordinates）</h2><p>bwa aln 参数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">$ bwa aln</div><div class="line">Usage:   bwa aln [options] &lt;prefix&gt; &lt;in.fq&gt;</div><div class="line">Options: </div><div class="line">        -n NUM      max #diff (int) or missing prob under 0.02 err rate (float) [0.04]</div><div class="line">        -o INT         maximum number or fraction of gap opens [1]</div><div class="line">        -i INT          do not put an indel within INT bp towards the ends [5]</div><div class="line">        -d INT         maximum occurrences for extending a long deletion [10]</div><div class="line">        -l INT          seed length [32]</div><div class="line">        -k INT         maximum differences in the seed [2]</div><div class="line">        -m INT        maximum entries in the queue [2000000]</div><div class="line">        -t INT          number of threads [1] </div><div class="line">                        #指定进程数</div><div class="line">        -M INT        mismatch penalty [3]</div><div class="line">        -O INT        gap open penalty [11]</div><div class="line">        -E INT         gap extension penalty [4]</div><div class="line">        -R INT         stop searching when there are &gt;INT equally best hits [30]</div><div class="line">        -q INT         quality threshold for read trimming down to 35bp [0]</div><div class="line">        -f FILE         file to write output to instead of stdout </div><div class="line">                        #指定输出文件名而不是标准输出</div><div class="line">        -B INT         length of barcode</div><div class="line">        -L                 log-scaled gap penalty for long deletions</div><div class="line">        -N                non-iterative mode: search for all n-difference hits (slooow)</div><div class="line">        -I                 the input is in the Illumina 1.3+ FASTQ-like format</div><div class="line">                        #输入文件是 Illumina 1.3+FASTQ-like格式</div><div class="line">        -b                the input read file is in the BAM format</div><div class="line">                        #输入的read是BAM格式</div><div class="line">        -0                use single-end reads only (effective with -b)</div><div class="line">                        #只使用单末端，使用-b时有效</div><div class="line">        -1                use the 1st read in a pair (effective with -b)</div><div class="line">                        #使用末端配对的第一个read，使用-b时有效</div><div class="line">        -2                use the 2nd read in a pair (effective with -b)</div><div class="line">                        #使用末端配对的第二个read，使用-b时有效</div><div class="line">        -Y                filter Casava-filtered sequences</div></pre></td></tr></table></figure></p>
<p>对于Paired-end reads，使用8进程运行，使用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ bwa aln -t 8 -f SRR2982241_1.sai ecoli.fa SRR2982241_1.fastq </div><div class="line">$ bwa aln -t 8 -f SRR2982241_2.sai ecoli.fa SRR2982241_2.fastq</div></pre></td></tr></table></figure>
<p>对于Single reads，使用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bwa aln -t 8 -f SRR1234567.sai refseq.fa SRR1234567.fastq</div></pre></td></tr></table></figure>
<h2 id="使用-bwa-sampe-或-bwa-samse-转换序列阵列坐标并输出sam"><a href="#使用-bwa-sampe-或-bwa-samse-转换序列阵列坐标并输出sam" class="headerlink" title="使用 bwa sampe 或 bwa samse 转换序列阵列坐标并输出sam"></a>使用 bwa sampe 或 bwa samse 转换序列阵列坐标并输出sam</h2><p>bwa sampe 和 bwa samse 参数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Paired-end reads:</div><div class="line">$ bwa sampe</div><div class="line">Usage:   bwa sampe [options] &lt;prefix&gt; &lt;in1.sai&gt; &lt;in2.sai&gt; &lt;in1.fq&gt; &lt;in2.fq&gt;</div><div class="line">Options: </div><div class="line">        -a INT   maximum insert size [500]</div><div class="line">        -o INT   maximum occurrences <span class="keyword">for</span> one end [100000]</div><div class="line">        -n INT   maximum hits to output <span class="keyword">for</span> paired reads [3]</div><div class="line">        -N INT   maximum hits to output <span class="keyword">for</span> discordant pairs [10]</div><div class="line">        -c FLOAT prior of chimeric rate (lower bound) [1.0e-05]</div><div class="line">        -f FILE  sam file to output results to [stdout]</div><div class="line">        <span class="comment">#定输出sam文件而不是标准输出</span></div><div class="line">        -r STR   <span class="built_in">read</span> group header line such as `@RG\tID:foo\tSM:bar<span class="string">' [null]</span></div><div class="line">        -P       preload index into memory (for base-space reads only)</div><div class="line">        -s       disable Smith-Waterman for the unmapped mate</div><div class="line">        -A       disable insert size estimate (force -s)</div><div class="line">Notes:</div><div class="line">    1. For SOLiD reads, &lt;in1.fq&gt; corresponds R3 reads and &lt;in2.fq&gt; to F3.</div><div class="line">    2. For reads shorter than 30bp, applying a smaller -o is recommended get a sensible speed at the cost of pairing accuracy.</div><div class="line"></div><div class="line">Single reads:</div><div class="line">$ bwa samse</div><div class="line">Usage: bwa samse [-n max_occ] [-f out.sam] [-r RG_line] &lt;prefix&gt; &lt;in.sai&gt; &lt;in.fq&gt;</div></pre></td></tr></table></figure></p>
<p>本例是Paired-end reads，使用命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bwa sampe -f paired-end.sam ecoli.fa SRR2982241_1.sai SRR2982241_2.sai SRR2982241_1.fastq SRR2982241_2.fastq</div></pre></td></tr></table></figure>
<p>对于Single reads，使用命令：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bwa samse -f single_reads.sam refseq.fa SRR1234567.sai SRR1234567.fastq</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;Bwa (Burrows-Wheeler Alignment Tool) 是一个将低分散序列比对到人类基因组等大参考基因组的软件包。它由三个算法组成：BWA-backtrack，BWA-SW 和 BWA-MEM。第一个算法BWA-backtrack针对最长 100bp 的 Illumina sequence reads。另外两个算法BWA-SW 和 BWA-MEM针对从70bp 到 1Mbp 的长序列。BWA-SW 和 BWA-MEM 具有相同的特征，比如长read的支持，支持分裂比对，但是BWA-MEM是最新的，更快，更精准，推荐用于高质量比对。 BWA-MEM 和 BWA-backtrack 相比处理70-100bp Illumina reads 拥有更好的性能。&lt;br&gt;对于所有的算法，BWA首先需要构建参考基因组的FM-index（使用 index 命令）。比对算法通过调用不同的子命令实现：BWA-backtrack 算法使用aln/samse/sampe，BWA-SW算法使用 bwasw，BWA-MEM 算法使用mem。&lt;br&gt;注：本例使用的bwa版本为：0.7.12-r1039。BWA手册&lt;a href=&quot;http://bio-bwa.sourceforge.net/bwa.shtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;查看此处&lt;/a&gt;。&lt;/p&gt;
    
    </summary>
    
    
      <category term="NGS" scheme="http://maoyibo.tk/tags/NGS/"/>
    
      <category term="Mapper" scheme="http://maoyibo.tk/tags/Mapper/"/>
    
      <category term="Manual" scheme="http://maoyibo.tk/tags/Manual/"/>
    
      <category term="Commands" scheme="http://maoyibo.tk/tags/Commands/"/>
    
  </entry>
  
  <entry>
    <title>机器学习基石  第一节 The Learning Problem</title>
    <link href="http://maoyibo.tk/2016/12/11/2016-12-11-MLF-1/"/>
    <id>http://maoyibo.tk/2016/12/11/2016-12-11-MLF-1/</id>
    <published>2016-12-11T09:10:24.000Z</published>
    <updated>2017-06-30T13:09:42.437Z</updated>
    
    <content type="html"><![CDATA[<h2 id="第一节-The-Learning-Problem"><a href="#第一节-The-Learning-Problem" class="headerlink" title="第一节 The Learning Problem"></a>第一节 The Learning Problem</h2><p>课程logo中红色表示使用机器学习是危险的，蓝色表示不危险。</p>
<a id="more"></a> 
<h3 id="课程设计"><a href="#课程设计" class="headerlink" title="课程设计"></a>课程设计</h3><p>机器学习是一门 <strong>理论</strong> 和 <strong>实际</strong> <strong>相结合</strong>的学科。<br>课程是面向基础的，不是面向理论或者面向方法的。课程包括机器学习的哲学基础、关键理论、关键技术、应用实例等所有机器学习使用者需要知道的知识。<br>包括：    </p>
<ol>
<li>什么时候使用机器学习（说明和技术）</li>
<li>为什么使用机器学习（理论和说明）</li>
<li>机器时如何学习的（技术和实践）</li>
<li>怎么样让机器更好的学习（实践和理论）</li>
</ol>
<h3 id="从学习到机器学习"><a href="#从学习到机器学习" class="headerlink" title="从学习到机器学习"></a>从学习到机器学习</h3><p>学习是通过观察积累经验进而获得技巧的过程</p>
<blockquote>
<p>观察-&gt;学习-&gt;技巧</p>
</blockquote>
<p>机器学习是从数据中积累或者计算得到经验进而获得技巧的过程</p>
<blockquote>
<p>数据-&gt;机器学习-&gt;技巧</p>
</blockquote>
<p><strong>技巧</strong>是指某种表现的增进。</p>
<p>应用场景：金融计算提高投资收益，图像识别，</p>
<h3 id="机器学习路径"><a href="#机器学习路径" class="headerlink" title="机器学习路径"></a>机器学习路径</h3><p>机器学习是构建一个复杂系统的方法。<br>用于：</p>
<ul>
<li>当不能手动编写整个系统</li>
<li>当不能简单的定义解决方法</li>
<li>当需要进行人不能做的快速决定</li>
<li>当需要做大尺度的面向用户服务</li>
</ul>
<h3 id="机器学习的关键"><a href="#机器学习的关键" class="headerlink" title="机器学习的关键"></a>机器学习的关键</h3><ol>
<li>存在一些潜在的模式可以被学习</li>
<li>但是没有一种简单的编程模式</li>
<li>存在包含潜在模式的数据</li>
</ol>
<h3 id="机器学习在日常生活，学习和娱乐中的应用"><a href="#机器学习在日常生活，学习和娱乐中的应用" class="headerlink" title="机器学习在日常生活，学习和娱乐中的应用"></a>机器学习在日常生活，学习和娱乐中的应用</h3><ol>
<li>分析Twitter数据分析餐厅卫生与否</li>
<li>分析销售数据和用户调查为用户提供流行推荐</li>
<li>分析建筑的特征和能量负荷分析其他类似建筑物的能量负荷</li>
<li>分析交通标志和意义准确的判断交通信号</li>
<li>分析数学教育系统中学生答题的数据，预测学生能够正确回答一个问题  </li>
<li>分析用户对一些电影的评价，预测使用者对未评价电影的评价</li>
</ol>
<h3 id="基本符号"><a href="#基本符号" class="headerlink" title="基本符号"></a>基本符号</h3><blockquote>
<p>输入：x ∈ X<br>输出：y ∈ Y<br>未知的模式：f : X → Y<br>数据训练集：data<br>最终假说：g: X → Y<br>{(x n , y n )} from f→ML→g<br>期望g≈f<br>机器学习算法：A<br>g属于假设集合 H，H包含好的或者坏的假设<br>机器学习算法A从假设集合H中找到最好的假设作为g。</p>
</blockquote>
<h3 id="机器学习与相关学科"><a href="#机器学习与相关学科" class="headerlink" title="机器学习与相关学科"></a>机器学习与相关学科</h3><p>机器学习 通过数据data来计算假设g近似目标f。<br>数据挖掘 使用（大）数据来发现有趣的性质。<br>人工智能 通过计算表现智能行为<br>统计使用数据对未知过程做出推论</p>
<ul>
<li>如果有趣的性质和假说是相似的则机器学习=数据挖掘</li>
<li>如果有趣的性质和假说相关则数据挖掘可以帮助机器学习，反之亦然。</li>
<li>传统的数据挖掘同时关注大数据的有效计算。</li>
<li>机器学习是人工智能的一种实现</li>
<li>统计可以被用于机器学习</li>
<li>传统的统计也关注数学假说的证明，较少关注计算</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;第一节-The-Learning-Problem&quot;&gt;&lt;a href=&quot;#第一节-The-Learning-Problem&quot; class=&quot;headerlink&quot; title=&quot;第一节 The Learning Problem&quot;&gt;&lt;/a&gt;第一节 The Learning Problem&lt;/h2&gt;&lt;p&gt;课程logo中红色表示使用机器学习是危险的，蓝色表示不危险。&lt;/p&gt;
    
    </summary>
    
    
      <category term="机器学习基石" scheme="http://maoyibo.tk/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3/"/>
    
      <category term="笔记" scheme="http://maoyibo.tk/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu Dependence Installation</title>
    <link href="http://maoyibo.tk/2016/12/10/2016-12-10-Ubuntu-Dependence-Installation/"/>
    <id>http://maoyibo.tk/2016/12/10/2016-12-10-Ubuntu-Dependence-Installation/</id>
    <published>2016-12-10T09:10:24.000Z</published>
    <updated>2017-06-30T13:09:02.648Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Ubuntu-依赖安装"><a href="#Ubuntu-依赖安装" class="headerlink" title="Ubuntu 依赖安装"></a>Ubuntu 依赖安装</h2><p>Ubuntu是一款很棒的系统，广泛用于科学计算和生物信息学研究中。但是仅仅安装系统是没有用的，更好的完成工作需要安装相应的软件，在Ubuntu 下安装软件少不了先安装依赖，这里我提供自己重装系统后安装软件和以来的脚本，可以给广大生物信息学同学提供一个参考。大家如果什么建议和补充欢迎和我交流！  </p>
<a id="more"></a>  
<p>安装脚本<a href="https://github.com/maoyibo/mybscript/blob/master/ubuntu_dependence_install.sh" title="Download page" target="_blank" rel="external">下载地址在此</a><br>此脚本包安装的内容包括：  </p>
<ul>
<li>一些开发工具，如 build-essential，gcc，make，git 等</li>
<li>一些常用IDE，如 eclipse，qt-sdk，vim等</li>
<li>一些视频软件和解码器，如 vlc gstreamer1.0-libav等</li>
<li>文泉驿字体</li>
<li>python的相关包</li>
<li>常用系统插件，如 nautilus-open-terminal p7zip icedtea-7-plugin</li>
<li>chromium浏览器</li>
<li>信息学相关包，如：openbabel，pymol， r-bioc-biobase等<br>-一些其他软件的依赖包，如：skype，amber等</li>
</ul>
<p>由于apt-get有很好的依赖解决能力，所以有些包并没有显示安装，而是通过安装依赖其的一些包达到自动安装，比如没有直接安装R，而是选择安装 r-bioc-biobase，通过依赖关系解决R包的安装问题，减少此文件的重复。大家可以选择性的安装自己需要的软件或者依赖。<br>如果大家对此脚本有什么修改意见和建议，或者自己有一些软件安装经验，欢迎和我交流，我会及时更新，方便大家更好的使用ubuntu。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Ubuntu-依赖安装&quot;&gt;&lt;a href=&quot;#Ubuntu-依赖安装&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 依赖安装&quot;&gt;&lt;/a&gt;Ubuntu 依赖安装&lt;/h2&gt;&lt;p&gt;Ubuntu是一款很棒的系统，广泛用于科学计算和生物信息学研究中。但是仅仅安装系统是没有用的，更好的完成工作需要安装相应的软件，在Ubuntu 下安装软件少不了先安装依赖，这里我提供自己重装系统后安装软件和以来的脚本，可以给广大生物信息学同学提供一个参考。大家如果什么建议和补充欢迎和我交流！  &lt;/p&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://maoyibo.tk/categories/Linux/"/>
    
    
      <category term="Ubuntu" scheme="http://maoyibo.tk/tags/Ubuntu/"/>
    
      <category term="Installation" scheme="http://maoyibo.tk/tags/Installation/"/>
    
      <category term="Script" scheme="http://maoyibo.tk/tags/Script/"/>
    
  </entry>
  
</feed>
